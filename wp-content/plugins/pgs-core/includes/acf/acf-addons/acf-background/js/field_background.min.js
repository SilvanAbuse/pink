!function(e){var a=1;e.reyBackground=e.reyBackground||{},e(document).ready(function(){e.reyBackground.init()}),e.reyBackground.init=function(){e(".rey-container-background .remove-image, .rey-container-background .remove-file .wp-picker-container").unbind("click").on("click",function(a){return e.reyBackground.removeImage(e(this).parents(".rey-container-background")),e.reyBackground.preview(e(this)),!1}),e(".rey-container-background .background_upload_button").unbind().on("click",function(a){e.reyBackground.addImage(a,e(this).parents(".rey-container-background"))}),e(".rey-background-input").on("change",function(){e.reyBackground.preview(e(this))}),e(".rey-container-background .rey-color").wpColorPicker()},e.reyBackground.preview=function(a){var i=a.parents(".rey-container-background:first"),n=e(i).find(".acf-field-body_background_previewer");if(n){i.data("id");var r="height:"+n.height()+"px;";e(i).find(".rey-background-input").each(function(){var a=e(this).serializeArray();(a=a[0])&&-1!=a.name.indexOf("[background")&&""!==a.value&&(a.name=a.name.split("["),a.name=a.name[2].replace("]",""),"background-image"==a.name?r+=a.name+':url("'+a.value+'");':r+=a.name+":"+a.value+";")}),n.attr("style",r).fadeIn()}},e.reyBackground.addImage=function(i,n){i.preventDefault();var r,t=jQuery(this);r?r.open():((r=wp.media({multiple:!1,library:{},title:t.data("choose"),button:{text:t.data("update")}})).on("select",function(){var i=r.state().get("selection").first();if(r.close(),"image"===i.attributes.type){n.find(".upload").val(i.attributes.url),n.find(".upload-id").val(i.attributes.id),n.find(".upload-height").val(i.attributes.height),n.find(".upload-width").val(i.attributes.width);var t=i.attributes.url;if(void 0!==i.attributes.sizes&&void 0!==i.attributes.sizes.thumbnail)t=i.attributes.sizes.thumbnail.url;else if(void 0!==i.attributes.sizes){var d=i.attributes.height;for(var o in i.attributes.sizes){var u=i.attributes.sizes[o];u.height<d&&(d=u.height,t=u.url)}}else t=i.attributes.icon;n.find(".upload-thumbnail").val(t),n.find(".upload").hasClass("noPreview")||(n.find(".screenshot").empty().hide().append('<img class="rey-option-image" src="'+t+'">').animate({width:"toggle"},150),n.find(".screenshot2").css("background-image","url("+i.attributes.url+")"),a=1),n.find(".remove-image").removeClass("hide"),e(".acf-background-uplaod-fields").css("width","calc(100% - 165px)"),n.find(".rey-background-input-properties").animate({width:"toggle"},150),e.reyBackground.preview(n.find(".upload"))}}),r.open())},e.reyBackground.removeImage=function(i){if(i.find(".remove-image").addClass("hide")){i.find(".screenshot2").css("background-image",""),i.find(".remove-image").addClass("hide"),i.find(".upload").val(""),i.find(".upload-id").val(""),i.find(".upload-height").val(""),i.find(".upload-width").val(""),i.find(".upload-thumbnail").val(""),i.find(".rey-background-input-properties").hide();var n=i.find(".screenshot");a&&(n.animate({width:"toggle"},300),a=1),i.find(".acf-background-uplaod-fields").animate({width:"100%"}),i.find(".remove-file").unbind(),jQuery(".section-upload .upload-notice").length>0&&jQuery(".background_upload_button").remove(),e.reyBackground.preview(i)}}}(jQuery);